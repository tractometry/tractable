<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform repeated sampling tests on an AFQ dataframe. — sampling_test • tractable</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform repeated sampling tests on an AFQ dataframe. — sampling_test"><meta name="description" content="When permutation_test == FALSE (the default), this function bootstrap
samples from an AFQ dataframe and returns pairwise differences at each node
for each bootstrap sample. These results can then be used to construct
bootstrap confidence intervals for the node-wise differences."><meta property="og:description" content="When permutation_test == FALSE (the default), this function bootstrap
samples from an AFQ dataframe and returns pairwise differences at each node
for each bootstrap sample. These results can then be used to construct
bootstrap confidence intervals for the node-wise differences."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tractable</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/changing-k.html">Changing model flexibility</a></li>
    <li><a class="dropdown-item" href="../articles/tractable-single-bundle.html">Fitting Generalized Additive Models (GAMs)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yeatmanlab/tractable/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Perform repeated sampling tests on an AFQ dataframe.</h1>
      <small class="dont-index">Source: <a href="https://github.com/yeatmanlab/tractable/blob/main/R/resample.R" class="external-link"><code>R/resample.R</code></a></small>
      <div class="d-none name"><code>sampling_test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When permutation_test == FALSE (the default), this function bootstrap
samples from an AFQ dataframe and returns pairwise differences at each node
for each bootstrap sample. These results can then be used to construct
bootstrap confidence intervals for the node-wise differences.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sampling_test</span><span class="op">(</span></span>
<span>  <span class="va">df_tract</span>,</span>
<span>  <span class="va">n_samples</span>,</span>
<span>  <span class="va">dwi_metric</span>,</span>
<span>  <span class="va">tract</span>,</span>
<span>  group_by <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  participant_id <span class="op">=</span> <span class="st">"subjectID"</span>,</span>
<span>  sample_uniform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  covariates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  smooth_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factor_a <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factor_b <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  permute <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df-tract">df_tract<a class="anchor" aria-label="anchor" href="#arg-df-tract"></a></dt>
<dd><p>AFQ Dataframe of node metric values for single tract</p></dd>


<dt id="arg-n-samples">n_samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>Number of sample tests to perform</p></dd>


<dt id="arg-dwi-metric">dwi_metric<a class="anchor" aria-label="anchor" href="#arg-dwi-metric"></a></dt>
<dd><p>The diffusion metric to model (e.g. "FA", "MD")</p></dd>


<dt id="arg-tract">tract<a class="anchor" aria-label="anchor" href="#arg-tract"></a></dt>
<dd><p>AFQ tract name</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>The grouping variable used to group nodeID smoothing terms</p></dd>


<dt id="arg-participant-id">participant_id<a class="anchor" aria-label="anchor" href="#arg-participant-id"></a></dt>
<dd><p>The name of the column that encodes participant ID</p></dd>


<dt id="arg-sample-uniform">sample_uniform<a class="anchor" aria-label="anchor" href="#arg-sample-uniform"></a></dt>
<dd><p>Boolean flag. If TRUE, shuffling should sample
uniformly from the unique values in the columns. If FALSE, shuffling
will shuffle without replacement.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>List of strings of GAM covariates, not including
the smoothing terms over nodes and the random effect due to subjectID.</p></dd>


<dt id="arg-smooth-terms">smooth_terms<a class="anchor" aria-label="anchor" href="#arg-smooth-terms"></a></dt>
<dd><p>Smoothing terms, not including
the smoothing terms over nodes and the random effect due to subjectID.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Dimension of the basis used to represent the node smoothing term</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Distribution to use for the gam. Must be 'gamma' or 'beta'</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Optional explicit formula to use for the GAM. If provided,
this will override the dynamically generated formula build from the
target, covariate, and k inputs. Default = NULL.</p></dd>


<dt id="arg-factor-a">factor_a<a class="anchor" aria-label="anchor" href="#arg-factor-a"></a></dt>
<dd><p>First group factor, string</p></dd>


<dt id="arg-factor-b">factor_b<a class="anchor" aria-label="anchor" href="#arg-factor-b"></a></dt>
<dd><p>Second group factor, string</p></dd>


<dt id="arg-permute">permute<a class="anchor" aria-label="anchor" href="#arg-permute"></a></dt>
<dd><p>Boolean flag. If TRUE, perform a permutation test.
Otherwise, do a bootstrap simulation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Dataframe with bootstrap or permutation test coefficients</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When permutation_test == TRUE, this function simulates the null distribution
using permutation testing. That is, it shuffles to destroy any relationships
between covariates and dwi_metrics. It then computes node-wise differences
for each shuffled sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">df_afq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"/path/to/afq/output.csv"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_tract</span> <span class="op">&lt;-</span> <span class="va">df_afq</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">df_afq</span><span class="op">$</span><span class="va">tractID</span> <span class="op">==</span> <span class="va">tract</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">bootstrap_coefs</span> <span class="op">&lt;-</span> <span class="fu">sampling_test</span><span class="op">(</span><span class="va">df_afq</span>,</span></span>
<span class="r-in"><span>                                 dwi_metric <span class="op">=</span> <span class="st">"dti_fa"</span>,</span></span>
<span class="r-in"><span>                                 covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"sex"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                 family <span class="op">=</span> <span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>                                 k <span class="op">=</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>                                 n_samples <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Richie-Halford, Kelly Chang, Teresa Gomez, McKenzie Hagen, Ariel Rokem.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

